Total_Pop_21 <- merge(Population_21, PostCR_suburbs_2021, by.x = "GEOID", by.y = "GEOID") %>%
select(GEOID, total_21, moe_21, State, PostCRsuburb) %>%
distinct(GEOID, .keep_all = TRUE)
#Join both years
PostCRTotal_Population <- merge(Total_Pop_11, Total_Pop_21, by.x = "GEOID", by.y = "GEOID", all = TRUE)
#INNER/OUTER Suburbs
#2011
#load 2011 INNER/OUTER tracts
load("/Users/billy/Library/CloudStorage/OneDrive-ThePennsylvaniaStateUniversity/Suburban typologies Paper/Inner-Outer/InnerOuter_2011.Rdata")
#Join tracts to data (and remove duplicate)
Total_Pop_11 <- merge(Population_11, InnerOuter_Suburbs_2011, by.x = "GEOID", by.y = "GEOID") %>%
select(GEOID, total_11, moe_11, Suburb)
#2021
#Load 2021 POST CR tracts
load("/Users/billy/Library/CloudStorage/OneDrive-ThePennsylvaniaStateUniversity/Suburban typologies Paper/Inner-Outer/InnerOuter_2021.Rdata")
#Join tracts to data (and remove duplicate)
Total_Pop_21 <- merge(Population_21, InnerOuter_Suburbs_2021, by.x = "GEOID", by.y = "GEOID") %>%
select(GEOID, total_21, moe_21, Suburb)
#Join both years
IOTotal_Population <- merge(Total_Pop_11, Total_Pop_21, by.x = "GEOID", by.y = "GEOID", all = TRUE)
#Combining all suburban populations into one object
Total_Population <- merge(IOTotal_Population, PostCRTotal_Population, by.x = "GEOID", by.y = "GEOID", all = TRUE)
Total_Population <- merge(Total_Population, NCDPTotal_Population, by.x = "GEOID", by.y = "GEOID", all = TRUE)
#General tidying
Total_Population <- Total_Population %>%
mutate(City = str_extract(GEOID, "^.{2}")) %>%
mutate(City = case_when(City == 37 ~ "Charlotte",
City == 45 ~ "Charlotte",
City == 42 ~ "Pittsburgh",
City == 54 ~ "Pittsburgh",
City == 39 ~ "Pittsburgh",
City == 41 ~ "Portland",
City == 53 ~ "Portland")) %>%
mutate(Total_2011 = coalesce(total_11.x, total_11.y, total_11),
Total_2021 = coalesce(total_21.x, total_21.y, total_21),
PostCRSuburb = coalesce(PostCRsuburb.x, PostCRsuburb.y),
Suburb = coalesce(Suburb.x, Suburb.y)) %>%
select(GEOID, City, Type, PostCRSuburb, Suburb, Total_2011, Total_2021)
#save(Total_Population,file = "~/OneDrive - The Pennsylvania State University/Suburban typologies Paper/TotalPopulation.Rdata")
#2011 Median HH income
Med_inc_11 <- get_acs(
geography = GEOG,
variables = "B19019_001",
state = ST,
year = YR) %>%
rename(income_11 = estimate,
incomemoe_11 = moe)
#Prepping the data
Pop_Totals <- Total_Population %>%
pivot_longer(
cols = c(Type, PostCRsuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarise(Total_2011 = sum(Total_2011, na.rm = T),
Total_2021 = sum(Total_2021, na.rm = T)) %>%
mutate(PercentChange = (Total_2021/Total_2011)-1) %>%
pivot_longer(
cols = c(Total_2011, Total_2021),
values_to = "Estimate"
) %>%
rename(Year = "name") %>%
mutate(Year = str_sub(Year, 7, -1)) %>%
mutate(Suburb = case_when(Type == "Yes" ~ "Post-Civil Rights",
Type == "No" ~ "Pre-Civil Rights",
Type == "Inner" ~ "Inner",
Type == "Outer" ~ "Outer",
Type == "NCDP" ~ "Non-CDP")) %>%
mutate(Definition = case_when(Type == "Yes" ~ "Age",
Type == "No" ~ "Age",
Type == "Inner" ~ "Distance",
Type == "Outer" ~ "Distance",
Type == "NCDP" ~ "Census Designated")) %>%
mutate(PercentChange=ifelse(row_number()%%2==1,NA,PercentChange))
Pop_Totals <- Total_Population %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarise(Total_2011 = sum(Total_2011, na.rm = T),
Total_2021 = sum(Total_2021, na.rm = T)) %>%
mutate(PercentChange = (Total_2021/Total_2011)-1) %>%
pivot_longer(
cols = c(Total_2011, Total_2021),
values_to = "Estimate"
) %>%
rename(Year = "name") %>%
mutate(Year = str_sub(Year, 7, -1)) %>%
mutate(Suburb = case_when(Type == "Yes" ~ "Post-Civil Rights",
Type == "No" ~ "Pre-Civil Rights",
Type == "Inner" ~ "Inner",
Type == "Outer" ~ "Outer",
Type == "NCDP" ~ "Non-CDP")) %>%
mutate(Definition = case_when(Type == "Yes" ~ "Age",
Type == "No" ~ "Age",
Type == "Inner" ~ "Distance",
Type == "Outer" ~ "Distance",
Type == "NCDP" ~ "Census Designated")) %>%
mutate(PercentChange=ifelse(row_number()%%2==1,NA,PercentChange))
ggplot(Pop_Totals[Pop_Totals$City == "Pittsburgh", ],
aes(y = Suburb, x = Estimate, alpha = Year, fill = Definition)) +
geom_col(width = 0.7, position = "dodge", show.legend=FALSE) +
geom_text(aes(x = Estimate, y = Suburb, label = scales::percent(PercentChange)),
hjust = -0.2, size = 4, color = "black", fontface = "bold", alpha = 1,
inherit.aes = TRUE, na.rm = T) +
theme_minimal(base_size = 12.5) +
theme(legend.key.size = unit(1, "cm"),
legend.position = "top",
strip.text = element_text(
size = 16, color = "black", face = "bold"),
strip.placement = "outside",
plot.title = element_text(hjust = 0.5, size = 22),
axis.title.x=element_blank(),
axis.title.y=element_blank()) +
labs(title = "Pittsburgh") +
scale_x_continuous(labels = scales::comma,
expand = c(0, 150000)) +
scale_fill_brewer(palette = "Dark2") +
scale_alpha_discrete(range = c(0.45, 1),
guide = "none") +
guides(fill = guide_legend(byrow = F,
label.position = "top")) +
facet_grid(rows = vars(Definition), scales = "free", switch = "y")
ggsave("PittsburghTotPop.png",
path = "~/desktop",
width = 11.5,
height = 7,
units = "in",
dpi = 500)
ggplot(Pop_Totals[Pop_Totals$City == "Portland", ],
aes(y = Suburb, x = Estimate, alpha = Year, fill = Definition)) +
geom_col(width = 0.7, position = "dodge", show.legend=FALSE) +
geom_text(aes(x = Estimate, y = Suburb, label = scales::percent(PercentChange)),
hjust = -0.2, size = 4, color = "black", fontface = "bold", alpha = 1,
inherit.aes = TRUE, na.rm = T) +
theme_minimal(base_size = 12.5) +
theme(legend.key.size = unit(1, "cm"),
legend.position = "top",
strip.text = element_text(
size = 16, color = "black", face = "bold"),
strip.placement = "outside",
plot.title = element_text(hjust = 0.5, size = 22),
axis.title.x=element_blank(),
axis.title.y=element_blank()) +
labs(title = "Portland") +
scale_x_continuous(labels = scales::comma,
expand = c(0, 150000)) +
scale_fill_brewer(palette = "Dark2") +
scale_alpha_discrete(range = c(0.45, 1),
guide = "none") +
guides(fill = guide_legend(byrow = F,
label.position = "top")) +
facet_grid(rows = vars(Definition), scales = "free", switch = "y")
ggsave("PortlandTotPop.png",
path = "~/desktop",
width = 11.5,
height = 7,
units = "in",
dpi = 500)
path = "~/desktop",
ggsave("PortlandTotPop.png",
path = "~/desktop",
width = 11.8,
height = 7,
units = "in",
dpi = 500)
ggsave("PortlandTotPop.png",
path = "~/desktop",
width = 12,
height = 7,
units = "in",
dpi = 500)
ggplot(Pop_Totals[Pop_Totals$City == "Charlotte", ],
aes(y = Suburb, x = Estimate, alpha = Year, fill = Definition)) +
geom_col(width = 0.7, position = "dodge", show.legend=FALSE) +
geom_text(aes(x = Estimate, y = Suburb, label = scales::percent(PercentChange)),
hjust = -0.2, size = 4, color = "black", fontface = "bold", alpha = 1,
inherit.aes = TRUE, na.rm = T) +
theme_minimal(base_size = 12.5) +
theme(legend.key.size = unit(1, "cm"),
legend.position = "top",
strip.text = element_text(
size = 16, color = "black", face = "bold"),
strip.placement = "outside",
plot.title = element_text(hjust = 0.5, size = 22),
axis.title.x=element_blank(),
axis.title.y=element_blank()) +
labs(title = "Charlotte") +
scale_x_continuous(labels = scales::comma,
expand = c(0, 150000)) +
scale_fill_brewer(palette = "Dark2") +
scale_alpha_discrete(range = c(0.45, 1),
guide = "none") +
guides(fill = guide_legend(byrow = F,
label.position = "top")) +
facet_grid(rows = vars(Definition), scales = "free", switch = "y")
ggsave("CharlotteTotPop.png",
path = "~/desktop",
width = 12,
height = 7,
units = "in",
dpi = 500)
load("/Users/billy/Library/CloudStorage/OneDrive-ThePennsylvaniaStateUniversity/Suburban typologies Paper/Output Data/TotalRace.Rdata")
Total_Race <- Total_Race %>%
mutate(City = str_extract(GEOID, "^.{2}")) %>%
mutate(City = case_when(City == 37 ~ "Charlotte",
City == 45 ~ "Charlotte",
City == 42 ~ "Pittsburgh",
City == 54 ~ "Pittsburgh",
City == 39 ~ "Pittsburgh",
City == 41 ~ "Portland",
City == 53 ~ "Portland")) %>%
mutate(NHWhite_11 = coalesce(NHWhite_E_11.x, NHWhite_E_11.y, NHWhite_E_11),
NHWhite_21 = coalesce(NHWhite_E_21.x, NHWhite_E_21.y, NHWhite_E_21),
NHBlack_11 = coalesce(NHBlack_E_11.x, NHBlack_E_11.y, NHBlack_E_11),
NHBlack_21 = coalesce(NHBlack_E_21.x, NHBlack_E_21.y, NHBlack_E_21),
Hispanic_11 = coalesce(Hispanic_E_11.x, Hispanic_E_11.y, Hispanic_E_11),
Hispanic_21 = coalesce(Hispanic_E_21.x, Hispanic_E_21.y, Hispanic_E_21),
Asian_11 = coalesce(NHAsian_E_11.x, NHAsian_E_11.y, NHAsian_E_11),
Asian_21 = coalesce(NHAsian_E_21.x, NHAsian_E_21.y, NHAsian_E_21),
SG_11 = coalesce(SmallGroups_E_11.x, SmallGroups_E_11.y, SmallGroups_E_11),
SG_21 = coalesce(SmallGroups_E_21.x, SmallGroups_E_21.y, SmallGroups_E_21),
PostCRSuburb = coalesce(PostCRsuburb.x, PostCRsuburb.y),
Suburb = coalesce(Suburb.x, Suburb.y)) %>%
select(GEOID, City, Type, PostCRSuburb, Suburb, NHWhite_11, NHWhite_21,
NHBlack_11, NHBlack_21, Hispanic_11, Hispanic_21, Asian_11, Asian_21,
SG_11)
Total_Race <- merge(IO_Race, PostCR_Race, by.x = "GEOID", by.y = "GEOID", all = TRUE)
Total_Race <- merge(Total_Race, NCDP_Race, by.x = "GEOID", by.y = "GEOID", all = TRUE)
#General tidying
Total_Race <- Total_Race %>%
mutate(City = str_extract(GEOID, "^.{2}")) %>%
mutate(City = case_when(City == 37 ~ "Charlotte",
City == 45 ~ "Charlotte",
City == 42 ~ "Pittsburgh",
City == 54 ~ "Pittsburgh",
City == 39 ~ "Pittsburgh",
City == 41 ~ "Portland",
City == 53 ~ "Portland")) %>%
mutate(NHWhite_11 = coalesce(NHWhite_E_11.x, NHWhite_E_11.y, NHWhite_E_11),
NHWhite_21 = coalesce(NHWhite_E_21.x, NHWhite_E_21.y, NHWhite_E_21),
NHBlack_11 = coalesce(NHBlack_E_11.x, NHBlack_E_11.y, NHBlack_E_11),
NHBlack_21 = coalesce(NHBlack_E_21.x, NHBlack_E_21.y, NHBlack_E_21),
Hispanic_11 = coalesce(Hispanic_E_11.x, Hispanic_E_11.y, Hispanic_E_11),
Hispanic_21 = coalesce(Hispanic_E_21.x, Hispanic_E_21.y, Hispanic_E_21),
Asian_11 = coalesce(NHAsian_E_11.x, NHAsian_E_11.y, NHAsian_E_11),
Asian_21 = coalesce(NHAsian_E_21.x, NHAsian_E_21.y, NHAsian_E_21),
SG_11 = coalesce(SmallGroups_E_11.x, SmallGroups_E_11.y, SmallGroups_E_11),
SG_21 = coalesce(SmallGroups_E_21.x, SmallGroups_E_21.y, SmallGroups_E_21),
PostCRSuburb = coalesce(PostCRsuburb.x, PostCRsuburb.y),
Suburb = coalesce(Suburb.x, Suburb.y)) %>%
select(GEOID, City, Type, PostCRSuburb, Suburb, NHWhite_11, NHWhite_21,
NHBlack_11, NHBlack_21, Hispanic_11, Hispanic_21, Asian_11, Asian_21,
SG_11)
save(Total_Race,file = "~/OneDrive - The Pennsylvania State University/Suburban typologies Paper/TotalRace.Rdata")
load("/Users/billy/Library/CloudStorage/OneDrive-ThePennsylvaniaStateUniversity/Suburban typologies Paper/Output Data/TotalRace.Rdata")
View(Total_Race)
Pop_Totals <- Total_Population %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name)
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name)
View(Race_Totals)
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarise_each(funs(sum))
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarise(across(everything(), sum))
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarise(across(where(is.numeric), sum))
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type)
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarize_if(is.numeric,sum,na.rm = TRUE)
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarize_if(is.numeric,sum,na.rm = TRUE) %>%
mutate(PercentChange = (NHWhite_21/NHWhite_11)-1)
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarize_if(is.numeric,sum,na.rm = TRUE) %>%
mutate(WhiteChange = (NHWhite_21/NHWhite_11)-1,
BlackChange = (NHBlack_21/NHBlack_11)-1)
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarize_if(is.numeric,sum,na.rm = TRUE) %>%
mutate(WhiteChange = (NHWhite_21/NHWhite_11)-1,
BlackChange = (NHBlack_21/NHBlack_11)-1,
HispanicChange = (Hispanic_21/Hispanic_11)-1,
AsianChange = (Asian_21/Asian_11)-1,
SGChange = (SG_21/SG_11)-1)
Total_Race <- Total_Race %>%
mutate(City = str_extract(GEOID, "^.{2}")) %>%
mutate(City = case_when(City == 37 ~ "Charlotte",
City == 45 ~ "Charlotte",
City == 42 ~ "Pittsburgh",
City == 54 ~ "Pittsburgh",
City == 39 ~ "Pittsburgh",
City == 41 ~ "Portland",
City == 53 ~ "Portland")) %>%
mutate(NHWhite_11 = coalesce(NHWhite_E_11.x, NHWhite_E_11.y, NHWhite_E_11),
NHWhite_21 = coalesce(NHWhite_E_21.x, NHWhite_E_21.y, NHWhite_E_21),
NHBlack_11 = coalesce(NHBlack_E_11.x, NHBlack_E_11.y, NHBlack_E_11),
NHBlack_21 = coalesce(NHBlack_E_21.x, NHBlack_E_21.y, NHBlack_E_21),
Hispanic_11 = coalesce(Hispanic_E_11.x, Hispanic_E_11.y, Hispanic_E_11),
Hispanic_21 = coalesce(Hispanic_E_21.x, Hispanic_E_21.y, Hispanic_E_21),
Asian_11 = coalesce(NHAsian_E_11.x, NHAsian_E_11.y, NHAsian_E_11),
Asian_21 = coalesce(NHAsian_E_21.x, NHAsian_E_21.y, NHAsian_E_21),
SG_11 = coalesce(SmallGroups_E_11.x, SmallGroups_E_11.y, SmallGroups_E_11),
SG_21 = coalesce(SmallGroups_E_21.x, SmallGroups_E_21.y, SmallGroups_E_21),
PostCRSuburb = coalesce(PostCRsuburb.x, PostCRsuburb.y),
Suburb = coalesce(Suburb.x, Suburb.y)) %>%
select(GEOID, City, Type, PostCRSuburb, Suburb, NHWhite_11, NHWhite_21,
NHBlack_11, NHBlack_21, Hispanic_11, Hispanic_21, Asian_11, Asian_21,
SG_11, SG_21)
#General tidying
Total_Race <- Total_Race %>%
mutate(City = str_extract(GEOID, "^.{2}")) %>%
mutate(City = case_when(City == 37 ~ "Charlotte",
City == 45 ~ "Charlotte",
City == 42 ~ "Pittsburgh",
City == 54 ~ "Pittsburgh",
City == 39 ~ "Pittsburgh",
City == 41 ~ "Portland",
City == 53 ~ "Portland")) %>%
mutate(NHWhite_11 = coalesce(NHWhite_E_11.x, NHWhite_E_11.y, NHWhite_E_11),
NHWhite_21 = coalesce(NHWhite_E_21.x, NHWhite_E_21.y, NHWhite_E_21),
NHBlack_11 = coalesce(NHBlack_E_11.x, NHBlack_E_11.y, NHBlack_E_11),
NHBlack_21 = coalesce(NHBlack_E_21.x, NHBlack_E_21.y, NHBlack_E_21),
Hispanic_11 = coalesce(Hispanic_E_11.x, Hispanic_E_11.y, Hispanic_E_11),
Hispanic_21 = coalesce(Hispanic_E_21.x, Hispanic_E_21.y, Hispanic_E_21),
Asian_11 = coalesce(NHAsian_E_11.x, NHAsian_E_11.y, NHAsian_E_11),
Asian_21 = coalesce(NHAsian_E_21.x, NHAsian_E_21.y, NHAsian_E_21),
SG_11 = coalesce(SmallGroups_E_11.x, SmallGroups_E_11.y, SmallGroups_E_11),
SG_21 = coalesce(SmallGroups_E_21.x, SmallGroups_E_21.y, SmallGroups_E_21),
PostCRSuburb = coalesce(PostCRsuburb.x, PostCRsuburb.y),
Suburb = coalesce(Suburb.x, Suburb.y)) %>%
select(GEOID, City, Type, PostCRSuburb, Suburb, NHWhite_11, NHWhite_21,
NHBlack_11, NHBlack_21, Hispanic_11, Hispanic_21, Asian_11, Asian_21,
SG_11, SG_21)
#Combining all suburban populations into one object
Total_Race <- merge(IO_Race, PostCR_Race, by.x = "GEOID", by.y = "GEOID", all = TRUE)
Total_Race <- merge(Total_Race, NCDP_Race, by.x = "GEOID", by.y = "GEOID", all = TRUE)
#General tidying
Total_Race <- Total_Race %>%
mutate(City = str_extract(GEOID, "^.{2}")) %>%
mutate(City = case_when(City == 37 ~ "Charlotte",
City == 45 ~ "Charlotte",
City == 42 ~ "Pittsburgh",
City == 54 ~ "Pittsburgh",
City == 39 ~ "Pittsburgh",
City == 41 ~ "Portland",
City == 53 ~ "Portland")) %>%
mutate(NHWhite_11 = coalesce(NHWhite_E_11.x, NHWhite_E_11.y, NHWhite_E_11),
NHWhite_21 = coalesce(NHWhite_E_21.x, NHWhite_E_21.y, NHWhite_E_21),
NHBlack_11 = coalesce(NHBlack_E_11.x, NHBlack_E_11.y, NHBlack_E_11),
NHBlack_21 = coalesce(NHBlack_E_21.x, NHBlack_E_21.y, NHBlack_E_21),
Hispanic_11 = coalesce(Hispanic_E_11.x, Hispanic_E_11.y, Hispanic_E_11),
Hispanic_21 = coalesce(Hispanic_E_21.x, Hispanic_E_21.y, Hispanic_E_21),
Asian_11 = coalesce(NHAsian_E_11.x, NHAsian_E_11.y, NHAsian_E_11),
Asian_21 = coalesce(NHAsian_E_21.x, NHAsian_E_21.y, NHAsian_E_21),
SG_11 = coalesce(SmallGroups_E_11.x, SmallGroups_E_11.y, SmallGroups_E_11),
SG_21 = coalesce(SmallGroups_E_21.x, SmallGroups_E_21.y, SmallGroups_E_21),
PostCRSuburb = coalesce(PostCRsuburb.x, PostCRsuburb.y),
Suburb = coalesce(Suburb.x, Suburb.y)) %>%
select(GEOID, City, Type, PostCRSuburb, Suburb, NHWhite_11, NHWhite_21,
NHBlack_11, NHBlack_21, Hispanic_11, Hispanic_21, Asian_11, Asian_21,
SG_11, SG_21)
save(Total_Race,file = "~/OneDrive - The Pennsylvania State University/Suburban typologies Paper/TotalRace.Rdata")
load("/Users/billy/Library/CloudStorage/OneDrive-ThePennsylvaniaStateUniversity/Suburban typologies Paper/Output Data/TotalRace.Rdata")
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarize_if(is.numeric,sum,na.rm = TRUE) %>%
mutate(WhiteChange = (NHWhite_21/NHWhite_11)-1,
BlackChange = (NHBlack_21/NHBlack_11)-1,
HispanicChange = (Hispanic_21/Hispanic_11)-1,
AsianChange = (Asian_21/Asian_11)-1,
SGChange = (SG_21/SG_11)-1)
load("/Users/billy/Library/CloudStorage/OneDrive-ThePennsylvaniaStateUniversity/Suburban typologies Paper/Output Data/TotalRace.Rdata")
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarize_if(is.numeric,sum,na.rm = TRUE) %>%
mutate(WhiteChange = (NHWhite_21/NHWhite_11)-1,
BlackChange = (NHBlack_21/NHBlack_11)-1,
HispanicChange = (Hispanic_21/Hispanic_11)-1,
AsianChange = (Asian_21/Asian_11)-1,
SGChange = (SG_21/SG_11)-1)
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarize_if(is.numeric,sum,na.rm = TRUE) %>%
mutate(WhiteChange = (NHWhite_21/NHWhite_11)-1,
BlackChange = (NHBlack_21/NHBlack_11)-1,
HispanicChange = (Hispanic_21/Hispanic_11)-1,
AsianChange = (Asian_21/Asian_11)-1,
SGChange = (SG_21/SG_11)-1) %>%
mutate(Suburb = case_when(Type == "Yes" ~ "Post-Civil Rights",
Type == "No" ~ "Pre-Civil Rights",
Type == "Inner" ~ "Inner",
Type == "Outer" ~ "Outer",
Type == "NCDP" ~ "Non-CDP")) %>%
mutate(Definition = case_when(Type == "Yes" ~ "Age",
Type == "No" ~ "Age",
Type == "Inner" ~ "Distance",
Type == "Outer" ~ "Distance",
Type == "NCDP" ~ "Census Designated"))
Race_Totals <- Total_Race %>%
pivot_longer(
cols = c(Type, PostCRSuburb, Suburb),
values_to = "Type"
) %>%
select(!name) %>%
drop_na(Type) %>%
group_by(City, Type) %>%
summarize_if(is.numeric,sum,na.rm = TRUE) %>%
mutate(WhiteChange = (NHWhite_21/NHWhite_11)-1,
BlackChange = (NHBlack_21/NHBlack_11)-1,
HispanicChange = (Hispanic_21/Hispanic_11)-1,
AsianChange = (Asian_21/Asian_11)-1,
SGChange = (SG_21/SG_11)-1) %>%
mutate(Suburb = case_when(Type == "Yes" ~ "Post-Civil Rights",
Type == "No" ~ "Pre-Civil Rights",
Type == "Inner" ~ "Inner",
Type == "Outer" ~ "Outer",
Type == "NCDP" ~ "Non-CDP")) %>%
mutate(Definition = case_when(Type == "Yes" ~ "Age",
Type == "No" ~ "Age",
Type == "Inner" ~ "Distance",
Type == "Outer" ~ "Distance",
Type == "NCDP" ~ "Census Designated")) %>%
select(City, Definition, Suburb, WhiteChange, BlackChange, HispanicChange, AsianChange, SGChange)
write.csv(Race_Totals, "/Users/billy/Library/CloudStorage/OneDrive-ThePennsylvaniaStateUniversity/Suburban typologies Paper/Output Data/RaceTotals.csv", row.names=T)
